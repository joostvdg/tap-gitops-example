---
tap_install:
  values:
    profile: build
    shared:
      ingress_domain: build.mydomain.com
      ca_cert_data: |-
        -----BEGIN CERTIFICATE-----
        MIID7jCCAtagAwIBAgIURv5DzXSDklERFu4gL2sQBNeRg+owDQYJKoZIhvcNAQEL
        ...
        sDAm0uiUdqs7FZN2uKkLKekdTgW0QkTFEJTk5Yk9t/hOrjnHoWQfB+mLhO3vPhip
        vhs=
        -----END CERTIFICATE-----
    buildservice:
      pull_from_kp_default_repo: true
      exclude_dependencies: true
      kp_default_repository: "harbor.mydomain.com/buildservice/tbs-full-deps"

    supply_chain: testing_scanning
    ootb_supply_chain_testing_scanning:
      external_delivery: true
      gitops:
        server_address: https://gitlab.mydomain.com
        repository_owner: root
        repository_name: tap-apps
        branch: main
        commit_strategy: pull_request
        pull_request:
          server_kind: gitlab
          commit_branch: ""
          pull_request_title: ready for review
          pull_request_body: generated by supply chain
      scanning:
        image:
          template: trivy-private-image-scan-template
          policy: trivy-scan-policy
        source:
          template: trivy-blob-source-scan-template
          policy: trivy-scan-policy
      registry:
        server: harbor.mydomain.com
        repository: tap-apps
    scanning:
      metadataStore:
        url: ""

    grype:
      metadataStore:
        url: https://metadata-store.mydomain.com
        caSecret:
          name: store-ca-cert
          importFromNamespace: metadata-store-secrets
        authSecret:
          name: store-auth-token
          importFromNamespace: metadata-store-secrets

    ceip_policy_disclosed: true
    
    contour:
      envoy:
        service:
          type: LoadBalancer

    namespace_provisioner:
      controller: false
      gitops_install:
        ref: origin/main
        subPath: platforms/clusters/build-01/namespace-provisioner
        url: git@github.com:joostvdg/tap-gitops-example.git
        secretRef:
          name: sync-git-ssh
          namespace: tanzu-sync
          create_export: false
      additional_sources:
      - git:
          ref: origin/main
          subPath: platforms/clusters/build-01/namespace-resources/testing-scanning-supplychain
          url: https://github.com/joostvdg/tap-gitops-example.git
          secretRef:
            name: github-https-token-2
            namespace: tanzu-sync
            create_export: false
        path: _ytt_lib/testing-scanning-supplychain-setup

    package_overlays:
      - name: "ootb-templates"
        secrets:
            - name: "config-writer-and-pull-requester-template-override"